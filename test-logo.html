<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Logo PDF</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="js/data-service.js"></script>
    <script src="js/pdf/cctv-pdf.js"></script>
</head>
<body>
    <h1>Test de Logo en PDF</h1>
    <button onclick="testLogoPDF()">Generar PDF con Logo Real</button>
    <div id="status"></div>
    
    <script>
        async function testLogoPDF() {
            const status = document.getElementById('status');
            status.innerHTML = 'Cargando datos de la empresa...';
            
            try {
                // Cargar datos reales de la empresa con logo
                const dataService = new DataService();
                const empresaData = await dataService.getEmpresa();
                
                console.log('Datos de empresa:', empresaData);
                status.innerHTML = 'Generando PDF con logo real...';
                
                // Crear datos de prueba básicos
                const formData = {
                    cliente: 'Cliente Test',
                    instalacion: 'Instalación Test',
                    sistema: 'CCTV',
                    fecha: new Date().toISOString().split('T')[0]
                };
                
                const info = {
                    cliente: { nombre: 'Cliente Test', rut: '12.345.678-9' },
                    instalacion: { nombre: 'Instalación Test', direccion: 'Dirección Test' },
                    empresa: empresaData // Usar datos reales con logo
                };
                
                // Generar PDF con logo ajustado
                const pdfGenerator = new CCTVPdfGenerator();
                const pdfBlob = await pdfGenerator.generate({
                    formData,
                    info,
                    equipos: [],
                    checklist: [],
                    evidencias: []
                });
                
                // Descargar PDF
                const url = URL.createObjectURL(pdfBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'test-logo-ajustado.pdf';
                a.click();
                
                status.innerHTML = '✅ PDF con logo ajustado generado correctamente';
                console.log('✅ PDF con logo real generado');
                
            } catch (error) {
                status.innerHTML = '❌ Error: ' + error.message;
                console.error('❌ Error al generar PDF:', error);
            }
        }
    </script>
</body>
</html>
